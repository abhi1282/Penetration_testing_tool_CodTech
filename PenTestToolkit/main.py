from modules.port_scanner import scan_ports
from modules.brute_forcer import brute_force_ssh
from modules.vulnerability_scanner import scan_vulnerabilities
from modules.packet_sniffer import start_sniffing
from utils.common import setup_logger

def main():
    logger = setup_logger()
    print("Penetration Testing Toolkit")
    print("1. Port Scanner")
    print("2. Brute Force SSH")
    print("3. Vulnerability Scanner")
    print("4. Packet Sniffer")
    choice = input("Choose an option: ")
    
    if choice == "1":
        target = input("Enter target IP: ")
        port_range = list(map(int, input("Enter port range (e.g., 22-80): ").split('-')))
        scan_ports(target, range(port_range[0], port_range[1] + 1))
    elif choice == "2":
        target = input("Enter target IP: ")
        username = input("Enter username: ")
        password_list = input("Enter password list (comma-separated): ").split(',')
        brute_force_ssh(target, username, password_list)
    elif choice == "3":
        target = input("Enter target IP: ")
        scan_vulnerabilities(target)
    elif choice == "4":
        interface = input("Enter network interface: ")
        start_sniffing(interface)
    else:
        print("Invalid choice")

if __name__ == "__main__":
    main()
